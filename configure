#!/bin/bash

PREFIX=""
EXECPREFIX=""

function printUsageAndExit {
   echo -e "Usage\n" \
           "   Options:\n" \
           "      -p T      Set prefix to T.\n" \
           "      --help          Print this message.\n";
   exit 0;
}

# Ensures cmake exists.
function findCMake {

   if [ -z $(which cmake) ]
   then
      echo "ERROR: cmake not installed";
      exit 1;
   fi

}

findCMake;

# Get options.
while getopts "p:h" option
do
   case $option in
      p) PREFIX="$OPTARG";;
      h) printUsageAndExit ;;
   esac
done

# Cmake defaults CMAKE_INSTALL_PREFIX=/usr/local.
# This is not good for debian, so try to detect debian/ubuntu.
grep -i ubuntu /etc/issue > /dev/null 2> /dev/null || grep -i debian /etc/issue > /dev/null 2> /dev/null
if [ $? == 0 ]
then
   PREFIX=/usr;
fi

echo "Prefix: $PREFIX";

# If we have a prefix...
if [ -z $PREFIX ]
then
   #...define the prefix.
   cmake -DCMAKE_INSTALL_PREFIX="$PREFIX" .
else
   #...just run cmake.
   cmake .
fi

